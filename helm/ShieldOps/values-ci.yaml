# ------------------------------------------------------------------------
# üöÄ ShieldOps CI/CD Helm Values (used by Jenkins)
# ------------------------------------------------------------------------

global:
  imageRegistry: docker.io
  pullPolicy: Always

# ------------------------------------------------------------------------
# üß† Backend (dynamic tags injected by Jenkins)
# ------------------------------------------------------------------------
backend:
  image:
    repository: ${REGISTRY}/shieldops
    tag: backend        # ‚Üê Jenkins dynamically replaces this
    pullPolicy: Always
  replicaCount: 2
  port: 8081
  serviceType: ClusterIP

  env:
    NODE_ENV: "production"
    JWT_SECRET: "change-me"
    TOKEN_EXPIRY: "4h"

  livenessProbe:
    httpGet:
      path: /api/health
      port: 8081
    initialDelaySeconds: 10
    periodSeconds: 15

  readinessProbe:
    httpGet:
      path: /api/health
      port: 8081
    initialDelaySeconds: 5
    periodSeconds: 10

# ------------------------------------------------------------------------
# üé® UI (dynamic tag from Jenkins)
# ------------------------------------------------------------------------
ui:
  image:
    repository: ${REGISTRY}/shieldops
    tag: ui
    pullPolicy: Always
  replicaCount: 2
  port: 80
  serviceType: ClusterIP

  livenessProbe:
    httpGet:
      path: /
      port: 80
    initialDelaySeconds: 10
    periodSeconds: 15

  readinessProbe:
    httpGet:
      path: /
      port: 80
    initialDelaySeconds: 5
    periodSeconds: 10

# ------------------------------------------------------------------------
# üåê Ingress (shared across CI/CD)
# ------------------------------------------------------------------------
ingress:
  enabled: true
  className: nginx
  hostname: shieldops.local
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/proxy-body-size: "20m"
  tls:
    enabled: false
  paths:
    - path: /
      pathType: Prefix
      service: ui
      port: 80
    - path: /api
      pathType: Prefix
      service: backend
      port: 8081
